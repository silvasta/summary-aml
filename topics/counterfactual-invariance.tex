
\section{Counterfactual Invariance}

SCM: $X_i = f_i(\mathbf{PA}_i, U_i)$, where $\mathbf{PA}_i$ are parents,
$U_i$ noise. Intervention do($X=x$): Replace $f_X$ with constant $x$.
$P(Y|do(X=x)) = \sum_z P(Y|X=x,Z=z) P(Z|X=x)$
\\
\text{Counterfactual}:
$P(Y_x = y | Y_{x'} = y')$

\begin{itemize}
  \item Invariance: Model $f$ is counterfactually invariant if $f(X, do(A)) =
    f(X)$ for action $A$ (e.g., distribution shift robustness).
\end{itemize}

\textbf{Invariance Condition}\\
$\mathbb{E}[Y | X, E] = \mathbb{E}[Y | X]$ for environment $E$

\section{Reproducing Kernel Hilbert Spaces (RKHS)}

\begin{definition}[RKHS]
  Hilbert space $\mathcal{H}$ where eval $f \mapsto f(x)$ continuous.
  Reproducing: $f(x) = \langle f, K(\cdot, x) \rangle_{\mathcal{H}}$.
\end{definition}

\begin{itemize}
  \item Kernel ridge reg.: $\hat{f} = \argmin_f \|f\|_{\mathcal{H}}^2 +
    \frac{1}{n} \sum_i (y_i - f(x_i))^2$. Sol: $\boldsymbol{\alpha} =
    (\mathbf{K}
    + \lambda \mathbf{I})^{-1} \mathbf{y}$.
\end{itemize}

